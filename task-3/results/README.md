# Описание

Exporter - легкое приложение, которое может выгрузить содержимое таблиц из БД в csv файл по заданному пути. В качестве аргументов командной строки принимает строку подключения к БД, целевую папку и далее можно вводить неограниченное количество таблиц, которые нужно экспортировать. Для данного приложения сделан dockerfile, где в качестве аргументов командной строки подставляются переменные окружения CONNECTION_STRING, TARGET_FOLDER и TABLE_NAMES.

Для этого приложения сделана конфигурация CronJob `exporter-job.yaml`. Обратите внимание, что для теста используется лишь две таблицы: shipment и shipment_events.

Для тестирования примените namespace.yaml:

```sh
kubectl apply -f namespace.yaml
```

Затем `postgres.yaml`:

```sh
kubectl apply -f postgres.yaml
```

который поднимет и инициализирует пример БД для выгрузки данных.

После чего примените `exporter-job.yaml`:

```sh
kubectl apply -f exporter-job.yaml
```

И чтобы форсировать запуск выполните:

```sh
kubectl -n sprint4-task3 create job --from=cronjob/exporter-job exporter-job-test
```

В результате в /mnt/exp_res (VM Minikube) окажется результат выгрузки. Это папку можно примаунтить к папке хоста с помощью minikube mount. В боевом сценарии для выгрузки результата следует использовать PersistentVolume, а лучше object storage, например S3. Также следует спрятать строку подключения в секреты.
